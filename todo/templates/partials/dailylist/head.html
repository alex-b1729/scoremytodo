{% load tz %}

<div class="row align-items-center">
    <div class="col">
        {% with created_dt_tz=dailylist.created_dt|timezone:dailylist.reference_timezone %}
        <h1 id="list-date">
            <span class="text-nowrap">{{ created_dt_tz|date:'Y-m-d' }}</span>
            <small class="text-body-secondary">{{ created_dt_tz|date:'l' }}</small>
        </h1>
        {% endwith %}
    </div>
    <div class="col text-center">
        <div class="btn-group" role="group" aria-label="Change date">
            <a
                    href="{% url 'change_daily_list' dailylist.uid 'previous' %}"
                    role="button"
                    aria-label="Previous date"
                    title="Previous date"
                    class="btn btn-outline-secondary">
                <i class="bi bi-chevron-left"></i>
            </a>
            <a
                    href="{% url 'todays_list' %}"
                    type="button"
                    class="btn btn-{% if not dailylist.can_create_update_tasks %}outline-{% endif %}success">
                Today
            </a>
            {# Checking dailylist.can_create_update_tasks is a janky way to keep #}
            {# users from trying to move forward a day #}
            {# when they are on today's list. #}
            {# todo: Should explicitly check if there is a next (and previous!) todo #}
            {# todo: this rearranges the layout when switch from today to not today #}
            {# and only show arrow buttons if so. #}
            <a
                    role="button"
                    {% if not dailylist.can_create_update_tasks %}
                    href="{% url 'change_daily_list' dailylist.uid 'next' %}"
                    aria-label="Next date"
                    title="Next date"
                    class="btn btn-outline-secondary"
                    {% else %}
                    aria-disabled="true"
                    class="btn btn-outline-secondary disabled"
                    {% endif %}>
                <i class="bi bi-chevron-right"></i>
            </a>
        </div>
    </div>
</div>

<div id="change-timezone-target-div" class="m-3"></div>

{% with ref_tz=dailylist.reference_timezone %}
<div class="my-3 p-2 border-start border-4 border-secondary-subtle">
    <p class="mb-0">
        <strong>Created:</strong> {{ dailylist.created_dt|timezone:ref_tz }}
        <br>
        <strong>Timezone:</strong> {{ ref_tz }}
        {% if dailylist.can_checkoff_tasks %}
        (<a
                hx-get="{% url 'daily_list_select_timezone' uid=dailylist.uid %}"
                hx-target="#change-timezone-target-div"
                hx-swap="innerHTML"
                href="#">Change</a>)
        {% endif %}
    </p>
    {% if not dailylist.can_checkoff_tasks %}
    <p class="mt-3 mb-0">
        <u>Todo list is closed for editing.</u>
        <a href="#">
            <i class="bi bi-info-circle"></i>
        </a>
    </p>
    {% elif not dailylist.can_create_update_tasks %}
    <p class="mt-3 mb-0">
        <u>Tasks can not be created or updated but can still be checked off.</u>
        <a href="#">
            <i class="bi bi-info-circle"></i>
        </a>
    </p>
    {% endif %}
</div>
{% endwith %}